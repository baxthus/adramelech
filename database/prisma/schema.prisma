generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Phrase {
  id        String   @id @default(nanoid())
  content   String
  source    String
  createdAt DateTime @default(now())

  @@index([createdAt])
  @@map("phrases")
}

model Profile {
  id        String   @id @default(nanoid())
  discordId String   @unique @db.VarChar(19)
  nickname  String?
  bio       String?
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  socials   Social[]
  feedbacks Feedback[]

  @@index([discordId])
  @@index([createdAt])
  @@map("profiles")
}

model Social {
  id        String @id @default(nanoid())
  profileId String
  name      String
  url       String

  profile Profile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@index([profileId])
  @@index([name])
  @@map("socials")
}

enum FeedbackStatus {
  OPEN
  ACKNOWLEDGED
  CLOSED
  RESOLVED
  ACCEPTED
  REJECTED
}

model Feedback {
  id        String         @id @default(nanoid())
  profileId String
  title     String
  content   String
  status    FeedbackStatus @default(OPEN)
  response  String?
  createdAt DateTime       @default(now())
  updatedAt DateTime       @default(now()) @updatedAt

  profile Profile @relation(fields: [profileId], references: [id], onDelete: Cascade)

  @@index([profileId])
  @@index([status])
  @@index([createdAt])
  @@map("feedbacks")
}
